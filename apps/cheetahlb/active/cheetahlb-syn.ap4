MAR_LOAD,$VIP_ADDR
ADDR_MASK
ADDR_OFFSET
MEM_READ // mbr now has bucket size
COPY_MBR2_MBR
MEM_INCREMENT // mbr now has counter value
COPY_MAR_MBR
COPY_MBR_MBR2
BIT_AND_MAR_MBR
COPY_MBR_MAR // mbr now has round-robin server index
COPY_MBR2_MBR
MAR_LOAD,$VIP_ADDR
ADDR_MASK
ADDR_OFFSET
MEM_READ // mbr now has offset to DIP pool
MAR_MBR_ADD_MBR2 // mar now has address to DIP
MEM_READ // mbr now has DIP
SET_DST
COPY_MBR2_MBR
NOP
LOAD_SALT
LOAD_TCP_5TUPLE
HASH
MBR_EQUALS_MBR2
DATA_0_LOAD_MBR
RETURN